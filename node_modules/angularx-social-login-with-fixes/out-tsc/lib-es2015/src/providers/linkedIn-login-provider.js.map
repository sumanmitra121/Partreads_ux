{"version":3,"file":"linkedIn-login-provider.js","sourceRoot":"","sources":["../../../lib/src/providers/linkedIn-login-provider.ts"],"names":[],"mappings":"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","sourcesContent":["import { BaseLoginProvider } from '../entities/base-login-provider';\r\nimport { SocialUser } from '../entities/user';\r\nimport { LoginOpt } from '../auth.service';\r\n\r\ndeclare let IN: any;\r\n\r\nexport class LinkedInLoginProvider extends BaseLoginProvider {\r\n\r\n    public static readonly PROVIDER_ID: string = 'LINKEDIN';\r\n\r\n    constructor(\r\n        private clientId: string,\r\n        private authorize?: boolean,\r\n        private lang?: string,\r\n        private fields: string = 'id,first-name,last-name,email-address,picture-url'\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    initialize(): Promise<void> {\r\n        let inner_text = '';\r\n\r\n        inner_text += 'api_key: ' + this.clientId + '\\r\\n';\r\n        inner_text += 'authorize:' + (this.authorize ? 'true' : 'false') + '\\r\\n';\r\n        inner_text += 'lang: ' + (this.lang ? this.lang : 'fr_FR') + '\\r\\n';\r\n\r\n        return new Promise((resolve, reject) => {\r\n            this.loadScript(LinkedInLoginProvider.PROVIDER_ID,\r\n                '//platform.linkedin.com/in.js',\r\n                () => {\r\n                    let that = this;\r\n                    setTimeout(() => {\r\n                        this._readyState.next(true);\r\n                        resolve();\r\n                    }, 800);\r\n                }, false, inner_text);\r\n        });\r\n    }\r\n\r\n    getLoginStatus(): Promise<SocialUser> {\r\n        return new Promise((resolve, reject) => {\r\n            this.onReady().then(() => {\r\n                this.signIn().then(\r\n                    user => resolve(user)\r\n                )\r\n            });\r\n        });\r\n    }\r\n\r\n    signIn(): Promise<SocialUser> {\r\n        return new Promise((resolve, reject) => {\r\n            this.onReady().then(() => {\r\n                IN.User.authorize(() => {\r\n                    IN.API.Raw(`/people/~:(${this.fields})`).result(function (res: any) {\r\n                        let user: SocialUser = new SocialUser();\r\n                        user.id = res.id;\r\n                        user.name = res.firstName + ' ' + res.lastName;\r\n                        user.email = res.emailAddress;\r\n                        user.photoUrl = res.pictureUrl;\r\n                        user.firstName = res.firstName;\r\n                        user.lastName = res.lastName;\r\n                        user.authToken = IN.ENV.auth.oauth_token;\r\n\r\n                        user.linkedIn = res;\r\n\r\n                        resolve(user);\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    signOut(): Promise<any> {\r\n        return new Promise((resolve, reject) => {\r\n            this.onReady().then(() => {\r\n                IN.User.logout(function () {\r\n                    resolve();\r\n                }, {});\r\n            });\r\n        });\r\n    }\r\n}\r\n"]}