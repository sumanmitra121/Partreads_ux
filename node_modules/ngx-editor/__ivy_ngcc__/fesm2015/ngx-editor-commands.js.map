{"version":3,"file":"ngx-editor-commands.js","sources":["../../../projects/ngx-editor/commands/removeLink.ts","../../../projects/ngx-editor/commands/applyMark.ts","../../../projects/ngx-editor/commands/removeMark.ts","../../../projects/ngx-editor/commands/ngx-editor-commands.ts"],"names":[],"mappings":"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","sourcesContent":["import { Command } from 'prosemirror-commands';\nimport { EditorState, Transaction } from 'prosemirror-state';\n\nexport const removeLink = (): Command => {\n  return (state: EditorState, dispatch?: (tr: Transaction) => void): boolean => {\n    const { doc, selection, tr } = state;\n    const { $head: { pos }, from, to } = selection;\n\n    // if the cursor is on the link without any selection\n    if (from === to) {\n      const $pos = doc.resolve(pos);\n      const linkStart = pos - $pos.textOffset;\n      const linkEnd = linkStart + $pos.parent.child($pos.index()).nodeSize;\n\n      tr.removeMark(linkStart, linkEnd);\n    } else {\n      tr.removeMark(from, to);\n    }\n\n    if (!tr.docChanged) {\n      return false;\n    }\n\n    dispatch?.(tr);\n    return true;\n  };\n};\n\nexport default removeLink;\n","import { MarkType } from 'prosemirror-model';\nimport { Command } from 'prosemirror-commands';\nimport { EditorState, TextSelection, Transaction } from 'prosemirror-state';\n\nimport { markApplies } from 'ngx-editor/helpers';\n\n// Ref: https://github.com/ProseMirror/prosemirror-commands/blob/master/src/commands.js\nexport const applyMark = (type: MarkType, attrs: Record<string, any> = {}): Command => {\n  return (state: EditorState, dispatch?: (tr: Transaction) => void): boolean => {\n    const { tr, selection } = state;\n    const { empty, ranges, $from, $to } = selection;\n\n    if (empty && selection instanceof TextSelection) {\n      const { $cursor } = selection;\n\n      if (!$cursor || !markApplies(state.doc, ranges, type)) {\n        return false;\n      }\n\n      tr.addStoredMark(type.create(attrs));\n      if (!tr.storedMarksSet) {\n        return false;\n      }\n\n      dispatch?.(tr);\n    } else {\n      tr.addMark($from.pos, $to.pos, type.create(attrs));\n\n      if (!tr.docChanged) {\n        return false;\n      }\n\n      dispatch?.(tr.scrollIntoView());\n    }\n\n    return true;\n  };\n};\n","import { MarkType } from 'prosemirror-model';\nimport { EditorState, TextSelection, Transaction } from 'prosemirror-state';\n\nimport { markApplies } from 'ngx-editor/helpers';\nimport { Command } from 'prosemirror-commands';\n\nexport const removeMark = (type: MarkType): Command => {\n  return (state: EditorState, dispatch?: (tr: Transaction) => void): boolean => {\n    const { tr, selection, storedMarks, doc } = state;\n    const { empty, ranges } = selection;\n\n    if (empty && selection instanceof TextSelection) {\n      const { $cursor } = selection;\n\n      if (!$cursor || !markApplies(state.doc, ranges, type)) {\n        return false;\n      }\n\n      if (type.isInSet(storedMarks || $cursor.marks())) {\n        tr.removeStoredMark(type);\n        dispatch?.(tr);\n        return true;\n      }\n    } else {\n      for (const range of ranges) {\n        const { $from, $to } = range;\n        const hasMark = doc.rangeHasMark($from.pos, $to.pos, type);\n\n        if (hasMark) {\n          tr.removeMark($from.pos, $to.pos, type);\n        }\n      }\n\n      if (!tr.docChanged) {\n        return false;\n      }\n\n      dispatch?.(tr.scrollIntoView());\n    }\n\n    return false;\n  };\n};\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"]}